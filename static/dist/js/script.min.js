document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('a[data-ajax="true"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();e=this.getAttribute("href");fetch(e).then(e=>e.text()).then(e=>{document.getElementById("main-content").innerHTML=e}).catch(e=>console.error("Error loading content:",e)),console.log(e)})});var e=io();let t=document.getElementById("terminal-output"),n={overall:document.getElementById("overall-progress"),playlist:document.getElementById("playlist-progress"),song:document.getElementById("song-progress")};e.on("log_update",function(e){t&&(t.innerHTML+=e.data+"\n",t.scrollTop=t.scrollHeight)}),e.on("progress_update",function(e){var t=n[e.type];t&&(t.value=e.value,t.max=e.max)}),e.on("song_info_update",function(e){e=e,document.getElementById("song-url").textContent=e.song_url||"",document.getElementById("playlist-url").textContent=e.playlist_url||"",document.getElementById("song-title").textContent=e.title||"",document.getElementById("song-styles").textContent=e.styles?.join(", ")||""}),document.getElementById("scrape-playlists")&&(document.getElementById("scrape-playlists")?.addEventListener("click",function(){fetch("/api/scrape/playlists").then(e=>e.json()).then(e=>{console.log("Started playlist scraping")})}),document.getElementById("scrape-songs")?.addEventListener("click",function(){fetch("/api/scrape/songs").then(e=>e.json()).then(e=>{console.log("Started song scraping")})})),document.getElementById("prepare-data")&&document.getElementById("prepare-data")?.addEventListener("click",function(){fetch("/api/prepare").then(e=>e.json()).then(e=>{console.log("Started data preparation")})}),document.getElementById("start-training")&&document.getElementById("start-training")?.addEventListener("click",function(){fetch("/api/train/start").then(e=>e.json()).then(e=>{console.log("Started training")})}),document.getElementById("generate-lyrics")&&document.getElementById("generate-lyrics")?.addEventListener("click",function(){var e={model:document.getElementById("generator-model").value,title:document.getElementById("song-title").value,style:document.getElementById("style-tags").value,prompt:document.getElementById("generation-prompt").value};fetch("/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{document.getElementById("generation-output").textContent=e.lyrics})}),document.querySelector("#scrape-playlists")?.addEventListener("click",function(){fetch("/api/scrape/playlists").then(e=>e.json()).then(e=>console.log("Started playlist scraping"))}),document.querySelector("#scrape-songs")?.addEventListener("click",function(){fetch("/api/scrape/songs").then(e=>e.json()).then(e=>console.log("Started song scraping"))}),document.querySelector("#prepare-data")?.addEventListener("click",function(){fetch("/api/prepare").then(e=>e.json()).then(e=>console.log("Started data preparation"))}),document.querySelector("#start-training")?.addEventListener("click",function(){fetch("/api/train/start").then(e=>e.json()).then(e=>console.log("Started training"))}),document.querySelector("#generate-lyrics")?.addEventListener("click",function(){var e={model:document.querySelector("#generator-model").value,title:document.querySelector("#song-title").value,style:document.querySelector("#style-tags").value,prompt:document.querySelector("#generation-prompt").value};fetch("/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{document.querySelector("#generation-output").textContent=e.lyrics})}),fetch("/api/settings").then(e=>e.json()).then(e=>{Object.entries(e).forEach(([n,e])=>{Object.entries(e).forEach(([e,t])=>{e=document.querySelector(`[data-category="${n}"][data-key="${e}"]`);e&&("checkbox"===e.type?e.checked=t:e.value=t)})})}),document.getElementById("save-settings").addEventListener("click",function(){let o={};document.querySelectorAll("[data-category][data-key]").forEach(e=>{var t=e.dataset.category,n=e.dataset.key,e="checkbox"===e.type?e.checked:e.value;o[t]||(o[t]={}),o[t][n]=e}),fetch("/api/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then(()=>UIkit.notification({message:"Settings saved successfully!",status:"success"}))}),document.getElementById("reset-settings").addEventListener("click",function(){confirm("Reset all settings to defaults?")&&fetch("/api/settings/reset").then(e=>e.json()).then(e=>{location.reload()})})});